pip install streamlit pandas plotly
import streamlit as st
import pandas as pd
import plotly.express as px

# ë°ì´í„° ë¡œë”©
daily_df = pd.read_excel("VOC_ì‹œì„¤ê°œì„ .xlsx", sheet_name="ì¼ì¼ì—…ë¬´ì²˜ë¦¬ê²°ê³¼")
stats_df = pd.read_excel("VOC_ì‹œì„¤ê°œì„ .xlsx", sheet_name="í†µê³„")

# ë‚ ì§œí˜• ë³€í™˜
daily_df['ì ‘ìˆ˜ì¼ì'] = pd.to_datetime(daily_df['ì ‘ìˆ˜ì¼ì'])

# ì›”ë³„ ì‹œì„¤ê°œì„  ê±´ìˆ˜
monthly_stats = stats_df.groupby('ì›”')['ì‹œì„¤ê°œì„ (ê±´)'].sum().reset_index()

# Streamlit ì‹œì‘
st.title("ğŸ¢ êµìœ¡ë¬¸í™”íŒ€ 2025ë…„ VOC ë° ì‹œì„¤ê°œì„  ëŒ€ì‹œë³´ë“œ")

# KPI ì¹´ë“œ
st.metric("ì´ VOC ê±´ìˆ˜", f"{len(daily_df)} ê±´")
avg_days = daily_df['ì²˜ë¦¬ê¸°ê°„'].mean()
st.metric("í‰ê·  ì²˜ë¦¬ ê¸°ê°„", f"{avg_days:.1f} ì¼")

# ì›”ë³„ ì¶”ì´
fig1 = px.bar(monthly_stats, x='ì›”', y='ì‹œì„¤ê°œì„ (ê±´)', title='ì›”ë³„ ì‹œì„¤ê°œì„  ê±´ìˆ˜')
st.plotly_chart(fig1)

# ì¥ì†Œë³„ ìƒìœ„ 10ê°œ
top_places = daily_df['ë°œìƒì¥ì†Œ'].value_counts().head(10).reset_index()
top_places.columns = ['ì¥ì†Œ', 'ê±´ìˆ˜']
fig2 = px.bar(top_places, x='ê±´ìˆ˜', y='ì¥ì†Œ', orientation='h', title='ì¥ì†Œë³„ VOC ìƒìœ„ 10')
st.plotly_chart(fig2)

# ìµœê·¼ VOC í…Œì´ë¸”
st.subheader("ğŸ“‹ ìµœê·¼ VOC ë¦¬ìŠ¤íŠ¸")
st.dataframe(daily_df[['ì ‘ìˆ˜ì¼ì', 'VOC ë° ì‹œì„¤ê°œì„ ', 'ë°œìƒì¥ì†Œ', 'ì²˜ë¦¬ë‚´ìš©']].sort_values(by='ì ‘ìˆ˜ì¼ì', ascending=False).head(10))
